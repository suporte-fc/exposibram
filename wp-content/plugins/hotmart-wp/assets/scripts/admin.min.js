!function(t){function a(t,a){var e=/(.*)([0-9]+)$/g;return t.replace(e,"$1")+(a||parseInt(t.replace(e,"$2"))+1)}function e(t,a,e,n){hot("action",t),hot("ad_title",a),hot("ad_image",e),hot("ad_hotlink",n),hot("plugin_version",hotmart_wp.version),hot("send",hotmart_wp.tracking_type)}function n(a,n){var i={};i.container=a.parents(".hotmart-ads-options-ad-container"),i.form=a.parents(".hotmart-ads-options-form"),i.id=i.container.attr("id"),i.title=i.form.find("input[name=hotmart_ad_title]").val(),i.image=i.form.find("input[name=hotmart_ad_image]").val(),i.hotlink=i.form.find("input[name=hotmart_ad_hotlink]").val(),i.enabled=i.form.find("input[name=hotmart_ad_enabled]:checked").val(),i.message=i.form.find(".hotmart-ads-options-message"),"hotmart_ad_insert_update"===n?(a.parent().children("button").attr("disabled",!0),t.post(hotmart_wp.ajaxurl,{action:n,id:i.id,title:i.title,image:i.image,hotlink:i.hotlink,enabled:i.enabled},function(t){var e=JSON.parse(t);i.message.html(e.message).fadeIn(800).addClass(e.status),e.id&&i.container.attr("id",e.id),setTimeout(function(){a.parent().children("button").attr("disabled",!1),i.message.fadeOut(800),setTimeout(function(){i.message.removeClass(e.status)},800)},3e3)})):"hotmart_ad_delete"===n&&(i.id&&t.post(hotmart_wp.ajaxurl,{action:n,id:i.id}),i.container.fadeOut(800),t(".hotmart-ads-options-ad-container").length>1&&setTimeout(function(){i.container.remove()},800)),e(n,i.title,i.image,i.hotlink)}t(".hotmart-ads-options-image-upload-button").live("click",function(a){var e=null;a.preventDefault();var n=t(this).prev(".hotmart-ads-options-input-image"),i=t(this).parents(".hotmart-ads-options-ad-container").find(n.data("preview_target"));(e=wp.media.frames.file_frame=wp.media({title:hotmart_wp.choose_image_text,button:{text:hotmart_wp.save_text},multiple:!1})).on("select",function(){attachment=e.state().get("selection").first().toJSON(),n.val(attachment.url),i.attr("src",attachment.url)}),e.open()}),t(".hotmart-ads-options-input-image").live("click focus",function(){t(this).blur().next("input[type=button]").click()}),t(".hotmart-ads-options-input").live("change",function(){var a=t(this).data("preview_attr"),e=t(this).parents(".hotmart-ads-options-ad-container").find(t(this).data("preview_target")),n=t(this).val();n?(a?e.attr(a,n):e.html(n),e.show()):e.hide()}),t(".hotmart-ads-options-save-button").live("click",function(a){a.preventDefault(),n(t(this),"hotmart_ad_insert_update")}),t(".hotmart-ads-options-delete-button").live("click",function(a){a.preventDefault(),window.confirm(hotmart_wp.alert_message)&&n(t(this),"hotmart_ad_delete")}),t(".hotmart-ads-options-add-button").click(function(e){e.preventDefault();var n=t(".hotmart-ads-options-ad-container:visible").length,i=n?t(this).prev(".hotmart-ads-options-ad-container").clone():t(this).prev(".hotmart-ads-options-ad-container").show(),o=null;i.removeAttr("id"),o=i.find(".hotmart-ads-options-ad-title"),n?o.html(a(o.html(),!1)):o.html(a(o.html(),1)),(o=i.find("input[name=hotmart_ad_title]")).val(""),(o=o.parents(".hotmart-ads-options-ad-container").find(o.data("preview_target"))).html(""),(o=i.find("input[name=hotmart_ad_image]")).val(""),(o=o.parents(".hotmart-ads-options-ad-container").find(o.data("preview_target"))).removeAttr("src"),(o=i.find("input[name=hotmart_ad_hotlink]")).val(""),(o=o.parents(".hotmart-ads-options-ad-container").find(o.data("preview_target"))).removeAttr("href"),(o=i.find("input[name=hotmart_ad_enabled][value=0]")).attr("checked",!1),(o=i.find("input[name=hotmart_ad_enabled][value=1]")).attr("checked",!0),(o=i.find(".hotmart-ads-options-insights-container")).remove(),t(this).before(i)})}(jQuery);